<!--
 * @Author: yuanzhen
 * @Date: 2022-09-13 15:51:02
 * @LastEditors: yuanzhen 2504621340@qq.com
 * @LastEditTime: 2022-09-14 09:45:54
 * @FilePath: \fabrich5\filter-demo.html
 * @Description: 
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="./dist/fabric.min.js"></script>
</head>

<body>
    <canvas style="border: 1px solid black;" width="800" height="800" id="canvas"></canvas>
    <button onclick="filterColor('#01FFFF')">过滤浅蓝色</button>
    <script>
        var imgurl = './image/eye.png'
        var reColorArr = ['#FF0D00', '#01FFFF', '#80FF00', '#0000FF']
        var selectArr = []
        filterColor(imgurl, reColorArr, selectArr)
        // 初始化加载图片
        function init(imgurl, reColorArr) {
            // 初始化画布
            var canvas = new fabric.Canvas('canvas');
            fabric.textureSize = 5000;
            fabric.Image.fromURL(imgurl, function (oImg) {
                oImg.scale(0.6)
                oImg.set('lockMovementX', true) //锁定X方向移动
                oImg.set('lockMovementY', true) //锁定Y方向移动
                oImg.set({ top: 10 });

                // 颜色滤除
                var filter = new fabric.Image.filters.RemoveColor({
                    color: reColorArr[0],
                    // color: "#01FFFF",  //移除的颜色
                    threshold: 40,
                    distance: 0.1
                });
                oImg.filters.push(filter);

                var filter2 = new fabric.Image.filters.RemoveColor({
                    color: reColorArr[1],
                    // color: "#01FFFF",  //移除的颜色
                    threshold: 40,
                    distance: 0.1
                });
                oImg.filters.push(filter2);

                var filter3 = new fabric.Image.filters.RemoveColor({
                    color: reColorArr[2],
                    // color: "#01FFFF",  //移除的颜色
                    threshold: 40,
                    distance: 0.1
                });
                oImg.filters.push(filter3);

                var filter4 = new fabric.Image.filters.RemoveColor({
                    color: reColorArr[3],
                    // color: "#01FFFF",  //移除的颜色
                    threshold: 40,
                    distance: 0.1
                });
                oImg.filters.push(filter4);



                canvas.add(oImg);
                oImg.applyFilters();
                canvas.renderAll();
            });
        }

        function filterColor(imgurl, removeColor, arr) {
            // 初始化画布
            var canvas = new fabric.Canvas('canvas');
            fabric.textureSize = 5000;
            fabric.Image.fromURL(imgurl, function (oImg) {
                oImg.scale(0.6)
                oImg.set('lockMovementX', true) //锁定X方向移动
                oImg.set('lockMovementY', true) //锁定Y方向移动
                oImg.set({ top: 10 });

                // 颜色滤除
                var filter1 = new fabric.Image.filters.RemoveColor({
                    color: reColorArr[0],
                    // color: "#01FFFF",  //移除的颜色
                    threshold: 40,
                    distance: 0.1
                });
                // oImg.filters.push(filter0);

                var filter2 = new fabric.Image.filters.RemoveColor({
                    color: reColorArr[1],
                    // color: "#01FFFF",  //移除的颜色
                    threshold: 40,
                    distance: 0.1
                });
                // oImg.filters.push(filter1);

                var filter3 = new fabric.Image.filters.RemoveColor({
                    color: reColorArr[2],
                    // color: "#01FFFF",  //移除的颜色
                    threshold: 40,
                    distance: 0.1
                });
                // oImg.filters.push(filter2);

                var filter4 = new fabric.Image.filters.RemoveColor({
                    color: reColorArr[3],
                    // color: "#01FFFF",  //移除的颜色
                    threshold: 40,
                    distance: 0.1
                });
                // oImg.filters.push(filter3);
                var filterArr = [filter1, filter2, filter3, filter4]
                for (let i = 1; i < reColorArr.length + 1; i++) {
                    if (!selectArr.includes(i)) {
                        oImg.filters.push(filterArr[i]);  // filter1  filter2 filter3 ....
                    }
                }





                canvas.add(oImg);
                oImg.applyFilters();
                canvas.renderAll();



            });
        }

        // 滤除红色 #FF0D00

        // 滤除浅蓝色 #01FFFF

        //滤除绿色 #80FF00

        //滤除深蓝色 #0000FF






    </script>

</body>

</html>